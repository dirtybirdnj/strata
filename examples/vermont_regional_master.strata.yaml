# Vermont Regional Master Map
# Complete replacement for vt-geodata generate_plotter_svgs.py
# Includes all neighboring states, Quebec, and major water bodies
#
# Matches vt-geodata layer set:
# - Regional backgrounds (Quebec MRC, NY/NH/MA/ME counties)
# - Town boundaries with water cutouts
# - Major lakes (Champlain, Memphremagog)
# - Regional hydro
# - Highway network

name: vermont_regional_master
description: Complete Vermont regional map with all neighboring areas
version: 1

sources:
  # ============================================================
  # VERMONT
  # ============================================================
  vt_towns:
    uri: census:tiger/2023/vt/cousub
    description: Vermont towns

  vt_water:
    uri: census:tiger/2023/vt/areawater
    description: Vermont lakes and ponds

  vt_rivers:
    uri: census:tiger/2023/vt/linearwater
    description: Vermont rivers and streams

  vt_roads:
    uri: census:tiger/2023/vt/prisecroads
    description: Vermont primary/secondary roads

  vt_counties:
    uri: census:tiger/2023/vt/county
    description: Vermont county boundaries

  # ============================================================
  # NEW YORK (Champlain Valley counties)
  # ============================================================
  ny_towns:
    uri: census:tiger/2023/ny/cousub
    description: New York towns

  ny_water:
    uri: census:tiger/2023/ny/areawater
    description: New York lakes and ponds

  ny_rivers:
    uri: census:tiger/2023/ny/linearwater
    description: New York rivers

  ny_roads:
    uri: census:tiger/2023/ny/prisecroads
    description: New York roads

  ny_counties:
    uri: census:tiger/2023/ny/county
    description: New York county boundaries

  # ============================================================
  # NEW HAMPSHIRE
  # ============================================================
  nh_towns:
    uri: census:tiger/2023/nh/cousub
    description: New Hampshire towns

  nh_water:
    uri: census:tiger/2023/nh/areawater
    description: New Hampshire lakes

  nh_rivers:
    uri: census:tiger/2023/nh/linearwater
    description: New Hampshire rivers

  nh_roads:
    uri: census:tiger/2023/nh/prisecroads
    description: New Hampshire roads

  nh_counties:
    uri: census:tiger/2023/nh/county
    description: New Hampshire county boundaries

  # ============================================================
  # MASSACHUSETTS
  # ============================================================
  ma_towns:
    uri: census:tiger/2023/ma/cousub
    description: Massachusetts towns

  ma_water:
    uri: census:tiger/2023/ma/areawater
    description: Massachusetts lakes

  ma_counties:
    uri: census:tiger/2023/ma/county
    description: Massachusetts county boundaries

  ma_rivers:
    uri: census:tiger/2023/ma/linearwater
    description: Massachusetts rivers

  # ============================================================
  # MAINE
  # ============================================================
  me_towns:
    uri: census:tiger/2023/me/cousub
    description: Maine towns

  me_water:
    uri: census:tiger/2023/me/areawater
    description: Maine lakes

  me_rivers:
    uri: census:tiger/2023/me/linearwater
    description: Maine rivers

  me_counties:
    uri: census:tiger/2023/me/county
    description: Maine county boundaries

  # ============================================================
  # VERMONT STATE BOUNDARY
  # ============================================================
  vt_state:
    uri: census:tiger/2023/vt/state
    description: Vermont state boundary

  # ============================================================
  # QUEBEC
  # ============================================================
  quebec_mrc:
    uri: quebec:mrc
    description: Quebec MRC boundaries (regional background)

  quebec_muni:
    uri: quebec:municipalities
    description: Quebec municipal boundaries

  quebec_hydro:
    uri: canada:canvec/hydro
    description: Quebec lakes from CanVec

  quebec_roads:
    uri: canada:nrn/qc
    description: Quebec road network

  quebec_rivers_richelieu:
    uri: canada:nhn/02OJ000/rivers
    description: Quebec rivers - Richelieu watershed

  quebec_rivers_champlain:
    uri: canada:nhn/02OHB00/rivers
    description: Quebec rivers - Lake Champlain area

  # ============================================================
  # RICHELIEU CORRIDOR (Lake Champlain to St. Lawrence)
  # ============================================================
  richelieu_hydro:
    uri: canada:nhn/02OJ000
    description: Richelieu River watershed from NHN

  # ============================================================
  # MISSISQUOI BAY (cross-border water)
  # NHN data for detailed Lake Champlain Quebec waters
  # ============================================================
  missisquoi_hydro:
    uri: canada:nhn/02OHB00
    description: Lake Champlain eastern portion including Missisquoi Bay

  # ============================================================
  # LAKE CHAMPLAIN (special handling)
  # ============================================================
  champlain_vt:
    uri: census:tiger/2023/vt/areawater
    filter:
      FULLNAME_contains: Champlain

  champlain_ny:
    uri: census:tiger/2023/ny/areawater
    filter:
      FULLNAME_contains: Champlain

layers:
  # ============================================================
  # BACKGROUND REGIONS (Order 1-10)
  # ============================================================

  # Quebec MRC backgrounds
  - name: quebec_background
    source: quebec_mrc
    operations:
      - type: simplify
        tolerance: 0.0005
    style:
      stroke: "#c9b99a"
      stroke_width: 0.5
      fill: "#f5ebe0"
    order: 1

  # NY counties background
  - name: ny_background
    source: ny_counties
    operations:
      - type: simplify
        tolerance: 0.0005
    style:
      stroke: "#8a9bab"
      stroke_width: 0.5
      fill: "#e3e8ed"
    order: 2

  # NH counties background
  - name: nh_background
    source: nh_counties
    operations:
      - type: simplify
        tolerance: 0.0005
    style:
      stroke: "#9e9e9e"
      stroke_width: 0.5
      fill: "#e8e8e8"
    order: 3

  # MA counties background
  - name: ma_background
    source: ma_counties
    operations:
      - type: simplify
        tolerance: 0.0005
    style:
      stroke: "#a89888"
      stroke_width: 0.5
      fill: "#ede5dc"
    order: 4

  # ME counties background
  - name: me_background
    source: me_counties
    operations:
      - type: simplify
        tolerance: 0.0005
    style:
      stroke: "#8aa898"
      stroke_width: 0.5
      fill: "#e0e8e4"
    order: 5

  # ============================================================
  # MAJOR WATER BODIES (Order 11-15)
  # Must be BEFORE towns so island cutouts work
  # ============================================================

  # Lake Champlain (merged VT + NY portions)
  - name: lake_champlain
    source: [champlain_vt, champlain_ny]
    operations:
      - type: dissolve
        by: HYDROID
      - type: merge
      - type: clean
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#0d47a1"
      stroke_width: 0.6
      fill: "#1565c0"
    order: 11

  # Lake Memphremagog (cross-border: VT + Quebec)
  - name: lake_memphremagog
    source: [vt_water, quebec_hydro]
    filter:
      min_area_km2: 10
    operations:
      - type: merge_touching
        buffer_distance: 0.001
      - type: clean
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#0d47a1"
      stroke_width: 0.5
      fill: "#1565c0"
    order: 12

  # Richelieu corridor (Lake Champlain to St. Lawrence)
  - name: richelieu_corridor
    source: richelieu_hydro
    filter:
      min_area_km2: 0.1
    operations:
      - type: merge
      - type: clean
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#0d47a1"
      stroke_width: 0.5
      fill: "#1565c0"
    order: 13

  # Missisquoi Bay Quebec waters (from NHN detailed data)
  - name: missisquoi_bay
    source: missisquoi_hydro
    filter:
      min_area_km2: 0.01
    operations:
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#0d47a1"
      stroke_width: 0.5
      fill: "#1565c0"
    order: 14

  # ============================================================
  # TOWN BOUNDARIES WITH WATER CUTOUTS (Order 20-30)
  # ============================================================

  # Quebec municipalities with water cutouts
  - name: quebec_municipalities
    source: quebec_muni
    operations:
      - type: subtract
        target: quebec_hydro
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#c9b99a"
      stroke_width: 0.3
      fill: none
    order: 20

  # NY towns with water cutouts
  - name: ny_towns
    source: ny_towns
    operations:
      - type: subtract
        target: ny_water
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#8a9bab"
      stroke_width: 0.3
      fill: none
    order: 21

  # NH towns with water cutouts
  - name: nh_towns
    source: nh_towns
    operations:
      - type: subtract
        target: nh_water
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#9e9e9e"
      stroke_width: 0.3
      fill: none
    order: 22

  # MA towns with water cutouts
  - name: ma_towns
    source: ma_towns
    operations:
      - type: subtract
        target: ma_water
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#a89888"
      stroke_width: 0.3
      fill: none
    order: 23

  # ME towns (no water cutouts - sparse population)
  - name: me_towns
    source: me_towns
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#8aa898"
      stroke_width: 0.3
      fill: none
    order: 24

  # VT towns with water cutouts (main focus)
  - name: vt_towns
    source: vt_towns
    operations:
      - type: subtract
        target: vt_water
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#424242"
      stroke_width: 0.5
      fill: none
      vary_fill: true
    order: 25

  # ============================================================
  # REGIONAL HYDRO (Order 30-40)
  # Shows through water cutouts in towns
  # ============================================================

  # NY lakes
  - name: ny_lakes
    source: ny_water
    filter:
      min_area_km2: 0.5
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#1976d2"
      stroke_width: 0.3
      fill: "#64b5f6"
    order: 31

  # NH lakes
  - name: nh_lakes
    source: nh_water
    filter:
      min_area_km2: 0.5
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#1976d2"
      stroke_width: 0.3
      fill: "#64b5f6"
    order: 32

  # Quebec lakes (from CanVec)
  - name: quebec_lakes
    source: quebec_hydro
    filter:
      min_area_km2: 0.5
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#1976d2"
      stroke_width: 0.3
      fill: "#64b5f6"
    order: 33

  # VT lakes
  - name: vt_lakes
    source: vt_water
    filter:
      min_area_km2: 0.3
    operations:
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#1976d2"
      stroke_width: 0.4
      fill: "#64b5f6"
    order: 35

  # MA lakes
  - name: ma_lakes
    source: ma_water
    filter:
      min_area_km2: 0.5
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#1976d2"
      stroke_width: 0.3
      fill: "#64b5f6"
    order: 36

  # ME lakes
  - name: me_lakes
    source: me_water
    filter:
      min_area_km2: 0.5
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#1976d2"
      stroke_width: 0.3
      fill: "#64b5f6"
    order: 37

  # ============================================================
  # RIVERS (Order 40-49)
  # Linear water features
  # ============================================================

  # VT rivers
  - name: vt_rivers
    source: vt_rivers
    operations:
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#42a5f5"
      stroke_width: 0.4
      fill: none
    order: 40

  # NY rivers
  - name: ny_rivers
    source: ny_rivers
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#42a5f5"
      stroke_width: 0.3
      fill: none
    order: 41

  # NH rivers
  - name: nh_rivers
    source: nh_rivers
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#42a5f5"
      stroke_width: 0.3
      fill: none
    order: 42

  # MA rivers
  - name: ma_rivers
    source: ma_rivers
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#42a5f5"
      stroke_width: 0.3
      fill: none
    order: 43

  # ME rivers
  - name: me_rivers
    source: me_rivers
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#42a5f5"
      stroke_width: 0.3
      fill: none
    order: 44

  # Quebec rivers (from NHN)
  - name: quebec_rivers
    source: [quebec_rivers_richelieu, quebec_rivers_champlain]
    operations:
      - type: simplify
        tolerance: 0.0004
    style:
      stroke: "#42a5f5"
      stroke_width: 0.3
      fill: none
    order: 45

  # ============================================================
  # ROADS (Order 50-60)
  # ============================================================

  # Quebec highways (Autoroutes)
  - name: quebec_highways
    source: quebec_roads
    filter:
      ROADCLASS: "Freeway"
    operations:
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#424242"
      stroke_width: 0.6
      fill: none
    order: 51

  # US Routes (all states)
  - name: us_routes
    source: [vt_roads, ny_roads, nh_roads]
    filter:
      RTTYP: "U"
    operations:
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#1976d2"
      stroke_width: 0.5
      fill: none
    order: 55

  # Interstates (all states)
  - name: interstates
    source: [vt_roads, ny_roads, nh_roads]
    filter:
      RTTYP: "I"
    operations:
      - type: simplify
        tolerance: 0.0003
    style:
      stroke: "#d32f2f"
      stroke_width: 0.8
      fill: none
    order: 60

  # ============================================================
  # VT STATE BOUNDARY (Order 100 - topmost)
  # ============================================================

  # Vermont state outline (thick green border)
  - name: vt_boundary
    source: vt_state
    operations:
      - type: simplify
        tolerance: 0.0002
    style:
      stroke: "#1e4320"
      stroke_width: 2.5
      fill: none
    order: 100

output:
  # Vermont-focused bounds with all neighbors visible
  bounds: [-73.9293, 42.4271, -71.1694, 45.50]
  projection: epsg:4326

  formats:
    - type: svg
      quality:
        - name: ultra_fine
          simplify: 0.0001
        - name: fine
          simplify: 0.0005
        - name: medium
          simplify: 0.001
      options:
        per_layer: true
        combined: true
        page_size: [12, 18]
        margin: 0.5

    - type: geojson
      options:
        per_layer: true
        precision: 6
